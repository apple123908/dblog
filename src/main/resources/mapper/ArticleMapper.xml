<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.three.modules.manage.dao.ArticleMapper">



    <select id="queryAmount" resultType="_int">
        select count(*) from t_article;
    </select>
    <select id="queryLast5Article" resultType="article">
        select id,title,create_time from t_article order by create_time desc limit 0,5;
    </select>

    <insert id="addReturnId" useGeneratedKeys="true" keyProperty="id" parameterType="article">
        insert into t_article(title,content,bg_images_id,type_id,author_id,status,is_publicity,is_discuss)
          values(
              #{title,jdbcType=VARCHAR},
              #{content,jdbcType=VARCHAR},
              #{bgImages.id,jdbcType=INTEGER},
              #{type.id,jdbcType=INTEGER},
              #{author.id,jdbcType=INTEGER},
              #{status,jdbcType=BIT},
              #{isPublicity,jdbcType=BIT},
              #{isDiscuss,jdbcType=BIT}
          )
    </insert>

    <!--在文章-标签表中插入数据-->
    <insert id="addMiddle" parameterType="java.util.List">
        insert into t_article_label(article_id,label_id)
        values
        <foreach collection="list" item="item" index="index" separator="," >
            (#{item.article_id},#{item.label_id})
        </foreach>
    </insert>

    <select id="queryAll" resultMap="articleTypeBean">
        select
            a.*,
            t.id as tId,
            t.name as tName
        from t_article a
            inner join t_type t on a.type_id=t.id
    </select>

</mapper>